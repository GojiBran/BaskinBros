<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BaskinBros OS</title>
  <link rel="stylesheet" href="https://unpkg.com/98.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      background: #008080;
      font-family: 'Tahoma', sans-serif;
      overflow-x: hidden;
    }
    .window { position: absolute; max-width: 600px; }
    .window-body { padding: 1rem; }
    .link-buttons a {
      padding: 0.5rem 1rem;
      border: 2px outset #fff;
      background: #c0c0c0;
      color: black;
      text-decoration: none;
      font-size: 0.85rem;
    }
    .link-buttons a:hover { background: #e0e0e0; }
    .hidden { display: none !important; }
    .taskbar {
      position: fixed; bottom: 0; left: 0; width: 100%;
      background: silver; border-top: 2px outset white;
      padding: 4px 8px; display: flex; justify-content: space-between;
      align-items: center; font-size: 0.75rem; z-index: 999;
    }
    .taskbar-left { display: flex; align-items: center; gap: 4px; }
    .taskbar-apps { display: flex; gap: 4px; }
    .taskbar-app-button {
      padding: 2px 8px; font-size: 0.75rem;
      background: #c0c0c0; border: 2px outset white;
      cursor: pointer; white-space: nowrap;
    }
    .taskbar-app-button.active {
      border: 2px inset #fff; background: #a0a0a0;
    }
    .taskbar-right {
      display: flex; align-items: center; gap: 6px;
      padding: 2px 6px; border: 2px inset #fff;
      background: #c0c0c0;
    }
    #startMenu {
      position: fixed; bottom: 36px; left: 0;
      display: none; z-index: 1000;
      background: silver; border: 2px outset white;
      max-height: 60vh; overflow-y: auto;
    }
    #startMenu a {
      display: block; padding: 4px 6px;
      text-decoration: none; color: black;
      font-size: 0.85rem;
    }
    #startMenu a:hover { background: #c0c0c0; border: 1px outset #fff; }
    .start-sidebar {
      width: 28px; background: navy; color: white;
      writing-mode: vertical-rl; text-align: center;
      font-weight: bold; padding: 4px 2px; font-size: 0.75rem;
    }

    /* Start button hover */
    .taskbar-left button:hover {
      background: #d0d0d0;
      border: 2px outset #fff;
      cursor: pointer;
    }

    /* Taskbar app buttons hover */
    .taskbar-app-button:hover:not(.active) {
      background: #dcdcdc;
      border: 2px outset #fff;
    }

    @media (max-width: 768px) {
      .window {
        width: 90% !important;
        left: 5% !important;
        transform: none !important;
      }
      .taskbar {
        flex-wrap: wrap;
        font-size: 0.7rem;
      }
      .taskbar-apps {
        flex-wrap: wrap;
      }
      #startMenu {
        max-height: 40vh;
        font-size: 0.75rem;
      }
    }
  </style>
</head>
<body>

  <!-- GOJI Window -->
  <div class="window" id="gojiWindow" data-title="Goji" data-default-top="40" data-default-z="102">
    <div class="title-bar">
      <div class="title-bar-text">
        <img src="/favicon.ico" style="height: 16px; vertical-align: middle; margin-right: 4px;" />
        Goji
      </div>
      <div class="title-bar-controls">
        <button aria-label="Minimize"></button>
        <button aria-label="Maximize"></button>
        <button aria-label="Close"></button>
      </div>
    </div>
    <div class="window-body link-buttons d-flex flex-column gap-2">
      <a href="https://www.youtube.com/@BaskinBros" target="_blank">üé• YouTube</a>
      <a href="https://soundcloud.com/gojibran" target="_blank">üéµ SoundCloud</a>
      <a href="https://github.com/GojiBran" target="_blank">üíª GitHub</a>
      <a href="https://baskinbros.itch.io/grax" target="_blank">üéÆ Grax Game</a>
    </div>
  </div>

  <!-- YOUTUBE Window -->
  <div class="window hidden" id="ytWindow" data-title="YouTube" data-default-top="80" data-default-z="101">
    <div class="title-bar">
      <div class="title-bar-text">YouTube</div>
      <div class="title-bar-controls">
        <button aria-label="Minimize"></button>
        <button aria-label="Maximize"></button>
        <button aria-label="Close"></button>
      </div>
    </div>
    <div class="window-body">
      <p>Watch videos by BaskinBros:</p>
      <a href="https://www.youtube.com/@BaskinBros" target="_blank">üé• youtube.com/@BaskinBros</a>
    </div>
  </div>

  <!-- SOUNDCLOUD Window -->
  <div class="window hidden" id="scWindow" data-title="SoundCloud" data-default-top="160" data-default-z="101">
    <div class="title-bar">
      <div class="title-bar-text">SoundCloud</div>
      <div class="title-bar-controls">
        <button aria-label="Minimize"></button>
        <button aria-label="Maximize"></button>
        <button aria-label="Close"></button>
      </div>
    </div>
    <div class="window-body">
      <p>Music from Goji:</p>
      <a href="https://soundcloud.com/gojibran" target="_blank">üéµ soundcloud.com/gojibran</a>
    </div>
  </div>

  <!-- GITHUB Window -->
  <div class="window hidden" id="gitWindow" data-title="GitHub" data-default-top="240" data-default-z="101">
    <div class="title-bar">
      <div class="title-bar-text">GitHub</div>
      <div class="title-bar-controls">
        <button aria-label="Minimize"></button>
        <button aria-label="Maximize"></button>
        <button aria-label="Close"></button>
      </div>
    </div>
    <div class="window-body">
      <p>Code projects by Goji:</p>
      <a href="https://github.com/GojiBran" target="_blank">üíª github.com/GojiBran</a>
    </div>
  </div>

  <!-- GRAX Window -->
  <div class="window hidden" id="graxWindow" data-title="Grax Game" data-default-top="320" data-default-z="101">
    <div class="title-bar">
      <div class="title-bar-text">Grax Game</div>
      <div class="title-bar-controls">
        <button aria-label="Minimize"></button>
        <button aria-label="Maximize"></button>
        <button aria-label="Close"></button>
      </div>
    </div>
    <div class="window-body">
      <p>Play the Grax platformer:</p>
      <a href="https://baskinbros.itch.io/grax" target="_blank">üéÆ baskinbros.itch.io/grax</a>
    </div>
  </div>

  <!-- Taskbar -->
  <div class="taskbar">
    <div class="taskbar-left">
      <button onclick="toggleStartMenu()">
        <img src="/favicon.ico" style="height: 14px; vertical-align: middle; margin-right: 4px;">
        BaskinBros
      </button>
      <div class="taskbar-apps" id="taskbarApps"></div>
    </div>
    <div class="taskbar-right">
      <span id="loadTime">0.00</span>
      <span id="footerClock">--:--</span>
    </div>
  </div>

  <!-- Start Menu -->
  <div id="startMenu">
    <div style="display: flex;">
      <div class="start-sidebar">Programs</div>
      <div style="min-width: 160px; padding: 6px;">
        <ul style="list-style: none; padding: 0; margin: 0;">
          <li>
            <a href="#" onclick="openWindow('gojiWindow')">
              <img src="/favicon.ico" style="height: 14px; vertical-align: middle; margin-right: 4px;">
              Goji
            </a>
          </li>
          <li><a href="#" onclick="openWindow('ytWindow')">üì∫ YouTube</a></li>
          <li><a href="#" onclick="openWindow('scWindow')">üéµ SoundCloud</a></li>
          <li><a href="#" onclick="openWindow('gitWindow')">üíæ GitHub</a></li>
          <li><a href="#" onclick="openWindow('graxWindow')">üïπÔ∏è Grax Game</a></li>
        </ul>
      </div>
    </div>
  </div>

<script>
  const windows = ["gojiWindow", "ytWindow", "scWindow", "gitWindow", "graxWindow"];
  const taskbarApps = document.getElementById("taskbarApps");
  let highestZ = 200; // ‚¨ÖÔ∏è Track the highest z-index in use

  function initWindow(id) {
    const win = document.getElementById(id);
    const titleBar = win.querySelector(".title-bar");
    const closeBtn = titleBar.querySelector("button[aria-label='Close']");
    const minimizeBtn = titleBar.querySelector("button[aria-label='Minimize']");
    const title = win.dataset.title || id;

    makeDraggable(titleBar, win);

    const taskBtn = document.createElement("button");
    taskBtn.innerHTML = `<img src="/favicon.ico" style="height: 14px; vertical-align: middle; margin-right: 4px;"> ${title}`;
    taskBtn.className = "taskbar-app-button active";
    taskBtn.id = "task-" + id;
    taskBtn.onclick = () => {
      if (win.classList.contains("hidden")) {
        win.classList.remove("hidden");
        taskBtn.classList.add("active");
        centerWindow(win);
        win.style.zIndex = ++highestZ; // ‚¨ÖÔ∏è Bring to front
      } else {
        win.classList.add("hidden");
        taskBtn.classList.remove("active");
      }
    };
    taskbarApps.appendChild(taskBtn);

    closeBtn.onclick = () => {
      win.classList.add("hidden");
      taskBtn.remove();
    };

    minimizeBtn.onclick = () => {
      win.classList.add("hidden");
      taskBtn.classList.remove("active");
    };

    // Bring to front on title click
    titleBar.addEventListener("mousedown", () => {
      win.style.zIndex = ++highestZ;
    });
  }

  function openWindow(id) {
    const win = document.getElementById(id);
    const taskBtn = document.getElementById("task-" + id);
    win.classList.remove("hidden");
    centerWindow(win);
    win.style.zIndex = ++highestZ; // ‚¨ÖÔ∏è Bring to front when opened
    if (!taskBtn) initWindow(id);
    else taskBtn.classList.add("active");
    toggleStartMenu(false);
  }

  function centerWindow(win) {
    const top = win.dataset.defaultTop || 100;
    win.style.top = top + "px";
    win.style.left = "50%";
    win.style.transform = "translateX(-50%)";
    win.style.zIndex = ++highestZ; // ‚¨ÖÔ∏è Also center brings forward
  }

  function makeDraggable(titleBar, win) {
    let isDragging = false, offsetX = 0, offsetY = 0;

    titleBar.addEventListener("mousedown", (e) => {
      isDragging = true;
      win.style.transform = "none";

      const rect = win.getBoundingClientRect();
      offsetX = e.clientX - rect.left;
      offsetY = e.clientY - rect.top;

      win.style.zIndex = ++highestZ; // ‚¨ÖÔ∏è Bring to front on drag
    });

    document.addEventListener("mousemove", (e) => {
      if (isDragging) {
        win.style.left = `${e.clientX - offsetX}px`;
        win.style.top = `${e.clientY - offsetY}px`;
      }
    });

    document.addEventListener("mouseup", () => {
      isDragging = false;
    });
  }

  function toggleStartMenu(forceClose = null) {
    const menu = document.getElementById("startMenu");
    if (forceClose === false) menu.style.display = "none";
    else menu.style.display = (menu.style.display === "block") ? "none" : "block";
  }

  window.addEventListener("DOMContentLoaded", () => {
    document.getElementById("loadTime").textContent = (performance.now() / 1000).toFixed(2);
    setInterval(() => {
      document.getElementById("footerClock").textContent =
        new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }, 1000);

    // Initialize all visible windows (like Goji) to avoid duplicate taskbar buttons
    windows.forEach(id => {
      const win = document.getElementById(id);
      if (!win.classList.contains("hidden")) {
        centerWindow(win);
        initWindow(id);
      }
    });
  });

  document.addEventListener("click", (e) => {
    const menu = document.getElementById("startMenu");
    if (menu.style.display === "block" && !menu.contains(e.target) && !e.target.closest("button[onclick^='toggleStartMenu']")) {
      menu.style.display = "none";
    }
  });
</script>
</body>
</html>
